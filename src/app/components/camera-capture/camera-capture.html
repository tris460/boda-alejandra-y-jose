<div class="camera-capture">
  <!-- Loading State -->
  <div class="camera-loading" *ngIf="isLoading">
    <div class="loading-spinner"></div>
    <p>Iniciando c치mara...</p>
  </div>

  <!-- Error State -->
  <div class="camera-error" *ngIf="error && !isLoading">
    <div class="error-icon">
      <svg viewBox="0 0 24 24">
        <path d="M12,2C13.1,2 14,2.9 14,4C14,5.1 13.1,6 12,6C10.9,6 10,5.1 10,4C10,2.9 10.9,2 12,2M21,9V7L15,1H5C3.89,1 3,1.89 3,3V21A2,2 0 0,0 5,23H19A2,2 0 0,0 21,21V9M19,9H14V4H5V19L14,10L19,15V9Z"/>
      </svg>
    </div>
    <h3>Error de c치mara</h3>
    <p>{{ error }}</p>
    <div class="error-actions">
      <button class="retry-btn" (click)="retry()">
        <svg viewBox="0 0 24 24">
          <path d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"/>
        </svg>
        Reintentar
      </button>
      <button class="cancel-btn" (click)="cancel()">Cancelar</button>
    </div>
  </div>

  <!-- Camera View -->
  <div class="camera-view" *ngIf="!error">
    <!-- Video Element - Siempre presente pero oculto cuando est치 cargando -->
    <div class="video-container" [style.visibility]="isLoading ? 'hidden' : 'visible'">
      <video #videoElement autoplay playsinline muted></video>
      
      <!-- Camera Overlay -->
      <div class="camera-overlay" *ngIf="!isLoading">
        <div class="viewfinder"></div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div class="camera-loading-overlay" *ngIf="isLoading">
      <div class="loading-spinner"></div>
      <p>Iniciando c치mara...</p>
    </div>

    <!-- Camera Controls -->
    <div class="camera-controls" *ngIf="!isLoading">
      <!-- Switch Camera Button -->
      <button class="switch-camera-btn" (click)="switchCamera()" *ngIf="cameraAvailable">
        <svg viewBox="0 0 24 24">
          <path d="M20,5H16.83L15,3H9L7.17,5H4A2,2 0 0,0 2,7V19A2,2 0 0,0 4,21H20A2,2 0 0,0 22,19V7A2,2 0 0,0 20,5M20,19H4V7H8.05L9.88,5H14.12L15.95,7H20V19M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8M12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14Z"/>
        </svg>
      </button>

      <!-- Capture Button -->
      <button 
        class="capture-btn" 
        (click)="capturePhoto()" 
        [disabled]="isCapturing">
        <div class="capture-inner" [class.capturing]="isCapturing">
          <svg viewBox="0 0 24 24" *ngIf="!isCapturing">
            <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>
          </svg>
          <div class="loading-spinner small" *ngIf="isCapturing"></div>
        </div>
      </button>

      <!-- Cancel Button -->
      <button class="cancel-btn" (click)="cancel()">
        <svg viewBox="0 0 24 24">
          <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
        </svg>
      </button>
    </div>
  </div>
</div>